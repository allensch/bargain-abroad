// Generated by CoffeeScript 1.6.2
(function() {
  App.AccountView = Ember.View.extend({
    selectedFilename: null,
    showingPrompt: false,
    didInsertElement: function() {
      var _this = this;

      this.$('.modal').on('shown.bs.modal', function() {
        _this.set('showingPrompt', true);
      });
      this.$('.modal').on('hide.bs.modal', function(e) {
        if (_this.get('controller.promptLoading')) {
          return false;
        }
      });
      this.$('.modal').on('hidden.bs.modal', function() {
        _this.resetPromptFormFields();
        _this.set('showingPrompt', false);
        _this.get('controller').resetPrompt();
      });
    },
    onPrompt: (function() {
      if (typeof this.$ === 'function' && this.$('.modal')) {
        if (this.get('controller.profileActionType') !== null) {
          this.$('.modal').modal('show');
        } else if (this.get('showingPrompt') === true) {
          this.$('.modal').modal('hide');
        }
      }
    }).observes('controller.profileActionType'),
    resetPromptFormFields: function() {
      this.$('.modal form').find('input').each(function(index, item) {
        $(item).val(null);
      });
    },
    actions: {
      handleSubmitProfile: function() {
        this.get('controller').profileActionSubmitProfile();
      },
      handleSubmitPrompt: function() {
        var data, form, valid;

        valid = this.get('controller').validPromptSubmit();
        if (valid !== true) {
          alert(valid);
          return;
        }
        form = this.$('.modal form');
        data = window.FormData ? new FormData(form[0]) : form.serialize();
        this.get('controller').profileActionSubmitPrompt(data);
      }
    }
  });

}).call(this);
