// Generated by CoffeeScript 1.6.2
(function() {
  var MSG_SUCCESS;

  MSG_SUCCESS = "Check your inbox. You'll receive an email with more information.";

  App.ForgotController = Ember.ObjectController.extend({
    messages: null,
    loading: false,
    errors: null,
    needs: ['login'],
    email: Ember.computed.alias('controllers.login.username'),
    init: function() {
      this._super();
      console.log('forgot controller');
    },
    actions: {
      cancel: function() {
        var e;

        try {
          history.go(-1);
        } catch (_error) {
          e = _error;
          this.transitionTo('index');
        }
      },
      submit: function() {
        var email, loading,
          _this = this;

        email = this.get('email');
        loading = this.get('loading');
        if (!loading && email) {
          this.set('loading', true);
          $.ajax({
            type: 'POST',
            url: '/rest/user/forgot',
            data: {
              email: email
            },
            success: function() {
              _this.setProperties({
                messages: [MSG_SUCCESS],
                loading: false,
                errors: null
              });
            },
            error: function(error) {
              _this.setProperties({
                messages: null,
                loading: false,
                errors: [error.responseText]
              });
            }
          });
        }
      }
    }
  });

}).call(this);
