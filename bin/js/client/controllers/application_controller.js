// Generated by CoffeeScript 1.6.2
(function() {
  var changeLocationTimeout, changeLocationTimes;

  changeLocationTimeout = 0;

  changeLocationTimes = 0;

  App.ApplicationController = Ember.ObjectController.extend({
    needs: ['auth'],
    init: function() {
      this._super();
      this.get('controllers.auth').authenticate();
    },
    onPathChange: (function() {
      this._checkForOpenModal();
      changeLocationTimes++;
      clearTimeout(changeLocationTimeout);
      changeLocationTimeout = setTimeout((function() {
        var page;

        $(document).scrollTop(0);
        if (changeLocationTimes > 1 && !Ember.isNone(window['ga'])) {
          page = window.location.hash.length > 0 ? window.location.hash.substring(1) : window.location.pathname;
          if (page.substr(0, 1) !== '/') {
            page = "/" + page;
          }
          ga('send', 'pageview', page);
        }
      }), 333);
    }).observes('currentPath'),
    _checkForOpenModal: function() {
      if (typeof $ === 'function') {
        if ($('.modal.fade.in').length) {
          $('.modal').modal('hide');
        }
        if ($('.modal-backdrop').length) {
          $('.modal-backdrop').remove();
          $('body').removeClass('modal-open');
        }
      }
    }
  });

}).call(this);
